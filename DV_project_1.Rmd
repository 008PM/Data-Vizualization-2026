---
title: "DV_project_Dasaradha_Prashob"
output:
  pdf_document: default
  html_document: default
Project: Version_14
---

# Mapping a Century of Measles: Time, Space, Seasonality, and Severity in the United States

![](THD.png)

Submitted by:

\
Dasaradha Jalapothu(22212530)

[dasaradha.jalapothu\@stud.th-deg.de](mailto:dasaradha.jalapothu@stud.th-deg.de){.email}

\
Prashob Mathiyambath(12400279)

[prashob.mathiyambath\@stud.th-deg.de](mailto:prashob.mathiyambath@stud.th-deg.de){.email}

## Overview {#overview}

In this project, we examine the rise, fall and resurgence of measles cases and deaths in United States over the long duration of 1888 to 2014 using Project Tycho Level 2 data to analyse, visualize and interpret the complete disease progression. By combining the disease surveillance data along with vaccination coverage information from sources such as World Health Organization (WHO), Centers for Disease Control and Prevention (CDC) and other external resources such as Kaggle. We explore disease dynamics across the three distinct phases.

Pre vaccine Phase (before 1963), when measles infected nearly every American child with substantial mortality. Vaccination Phase (1963-2000) showing how the disease was controlled dramatically with the introduction of vaccine in 1963 that achieved elimination status by 2000 and the Resurgence phase (2000-2014) that saw periodic outbreaks due to the decline in vaccination rates and localized clusters of vaccinated people. By using spatial,temporal analysis of trends and correlation with the intervention programs we demonstrate both the remarkable success of vaccination programs and the vulnerability of disease elimination, when there is a reduced immunization coverage.

# Table of contents

# Table of contents

| S. No. | Section                                                   |
|-------:|-----------------------------------------------------------|
|      1 | [Overview](#overview)                                     |
|      2 | [Introduction](#introduction)                             |
|      3 | [Problem definition](#problem-definition)                 |
|      4 | [Objectives](#objectives)                                 |
|      5 | [Methodology](#methodology)                               |
|      6 | [Results](#results)                                       |
|      7 | [Discussion and limitations](#discussion-and-limitations) |
|      8 | [Conclusion](#conclusion)                                 |
|      9 | [Literature](#literature)                                 |

## 1.Introduction {#introduction}

According to WHO, health comprises complete physical, mental and social well-being, not merely the absence of disease. Throughout the history of United States, measles has been one of the most significant public health challenges, representing historical progression trends from endemic disease to elimination and back to localized outbreaks. Before the availability of vaccine, measles was infecting approximately 95 percent of the US population by age 15 and an annual average of 3-4 million cases and 400-500 deaths.

With the development of the first measles vaccine in 1963 has transformed the disease landscape dramatically. Reported cases dropped by more than 97 percent between 1965 and 1968, demonstrating vaccination’s immediate impact. However, the outbreak again in 1990 among school children, revealing gaps in vaccine coverage, which led to the introduction of two dose MMR recommendation that finally achieved elimination status by the year 2000.Despite this achievement, measles has never completely disappeared from the US. After 2000, it has witnessed periodic outbreaks, in 2008 and 2014-2015. These resurgence cases occur when local vaccination rates affect the herd immunity. In this project, we utilize the Project Tycho Level 2 Data-set, a comprehensive repository of disease surveillance data developed by University of Pittsburgh. It compiles historical disease reports covering more than a century of public health surveillance across all states and over 100 cities in United States. The Level 2 data-set also provides standardized weekly counts of measles cases and deaths from 1888 to 2014. This rich historical data-set enables us to visualize the complete disease progression trajectory of measles in an unprecedented detail. By integrating external vaccination coverage data from WHO with Tycho Level 2 data, our goal is to comprehensively document how measles evolved from a universal childhood disease to a nearly eliminated infection and how decline in vaccination threatens this progress. Through statistical analysis and data visualization, we aim to demonstrate the direct relationship between public health interventions and disease control, while highlighting the ongoing importance of maintaining high vaccination coverage to prevent resurgence.

## 2.Problem definition: {#problem-definition}

Understanding the historical patterns of vaccine preventable diseases is crucial for public health decision making and communication. Although Project Tycho Level 2 data provides extensive weekly measles reports from 1888 to 2014, the size of the data-set and complexity makes it difficult to interpret and understand the trends without proper visualization tools. Comprehensive analysis that demonstrates how measles burden changed across various phases are lacking. Many important aspects remain inadequately addressed, including how measles cases and deaths evolved before and after vaccine introduction in 1963, which states and regions experienced the highest disease burden during each phase, what specific impact vaccination programs and policy interventions had on disease trends, and how after elimination outbreaks correlate with geographic clusters of low vaccination coverage. Additionally, the seasonal and temporal patterns that characterized measles transmission across different eras remain poorly documented. These insights are hidden without clear visualizations, hindering our ability to communicate the importance of sustained vaccination coverage and the risks of vaccine hesitancy. By systematically analyzing and visualizing the data, we aim to bridge that gap, reveal the complete trends of measles, and support evidence based public health communication.

## 3.Objectives: {#objectives}

The purpose of our analysis is to investigate the spatial, temporal, and intervention based trends of measles across the United States from 1888 to 2014. Our study aims to uncover the complete disease patterns of measles, demonstrating the impact of vaccination programs and enabling improved public health communication. The following are the key objectives:

1.  Characterize national measles trends over time: Aggregate reported measles cases by year to produce clear time‑series visualizations, identify major epidemic peaks and long term declines and highlight the timing of key milestones such as vaccine introduction and elimination efforts.

2.  Compare pre‑ and post‑vaccine periods: Quantify and visualize differences in national measles burden before and after 1963, using focused time windows around vaccine introduction to show how case counts changed during the transition from endemic transmission to control.​

3.  Describe spatial heterogeneity across states: Use choropleth maps and faceted map panels to visualize state level measles burden in different eras, emphasizing which regions carried the largest burden and how spatial patterns evolved between the 1950s and 1990s.

4.  Investigate temporal patterns by state using heat-maps: Construct a heat-map for the top twenty states by cumulative measles incidence to reveal persistent hotpots, periods of intense activity.

5.  Analyse seasonality and monthly patterns: Summarize measles cases by season and by calendar month across all years and visualize these aggregations using bar charts with confidence intervals and circular polar plots, to understand when within the year measles peaks most consistently occur.

6.  Explore city level burden and anomalies: Relate measles burden in major U.S. cities to their population size using log–log scatter-plots, and identify anomalous years in a selected city by computing z‑scores for annual case counts over a defined time window.

7.  Assess severity using deaths and case‑fatality ratios: Combine annual case and death counts to compute a case‑fatality ratio over time, and visualize both CFR trends and the joint trajectory of deaths versus cases to assess how the severity of measles evolved as control measures improved.

8.  Demonstrate reproducible data visualization practice. Implement all data preparation and plotting steps in a transparent, reproducible R Markdown document, ensuring that each figure is directly linked to code and that the workflow can be extended to related data-sets or diseases.

By meeting these objectives, the analysis offers insights into measles epidemiology across all three phases and demonstrates both the success of vaccination programs and the vulnerability of elimination status when immunization coverage declines.

## 4.Methodology {#methodology}

This project uses two data-sets:

1)  the Tycho Level 2 data-set (weekly reported cases of eight major infectious diseases in the United States, provided as part of the course task)

2)  an external U.S. mortality data-set from public online sources to analyze deaths over time.​

## 4.1.Data selection and objective framing

Data were filtered to the relevant years/locations to align with questions about temporal trends, seasonality, and geographic burden.​

## 4.2.Data analysis and visualization

Data wrangling was performed using dplyr/tidyverse verbs (e.g., `filter`, `group_by`, `summarise`, `mutate`, `join`) and date handling with lubridate where needed.​

## 4.3.Visual outputs (libraries - chart - purpose)

**Measles cases over time** : Libraries: ggplot2, dplyr, lubridate, scales (+ base R). Chart: line chart.Purpose: show the long-run trend in yearly measles incidence.​

**Before/after vaccine state maps** : Libraries: ggplot2, dplyr, lubridate, maps, scales, grid, patchwork. Chart: side-by-side choropleth maps. Purpose: compare geographic burden pre‑1963 vs post‑1963.​

**Top-20 states heatmap (1950–1980)** :Libraries: ggplot2, dplyr. Chart: heatmap (tile plot). Purpose: highlight which states and years contributed most to measles burden.​

**Seasonal distribution (with CI)** : Libraries: ggplot2, dplyr, lubridate, scales, viridis. Chart: bar chart with 95% CI error bars. Purpose: compare average seasonal incidence and uncertainty across seasons.​

**Monthly seasonal pattern** :Libraries: ggplot2, dplyr, lubridate, scales. Chart: polar bar chart. Purpose: show month-by-month seasonality and emphasize peak months via color intensity.​

**Measles by state over time (1950–1990)** :Libraries: ggplot2, dplyr, maps. Chart: faceted choropleth maps (snapshots) and/or single-year choropleths. Purpose: visualize how spatial patterns change across decades.​

**Resurgence annotated trend (1960–2000)** : Libraries: ggplot2, dplyr, lubridate, scales. Chart: annotated time-series line/area chart. Purpose: highlight vaccine introduction, elimination goals, and the 1989–1991 resurgence period.​

**Measles burden vs city size** :Libraries: ggplot2, dplyr, tibble, scales, lubridate, ggrepel. Chart: log–log scatter plot with fitted line. Purpose: assess how total cases scale with population among the largest cities.​

**Pre vs post vaccine (1953–1972)** : Libraries: ggplot2, dplyr, lubridate, scales. Chart: grouped/colored bar chart with a 1963 marker. Purpose: contrast annual burden before vs after vaccine licensure.​

**Most anomalous years (city z-scores)** : Libraries: ggplot2, dplyr, lubridate. Chart: bar chart of z-scores (top 10). Purpose: flag unusually high outbreak years (e.g., z ≥ 2) for a selected city.​

**Measles CFR over time (1919–1990)** : Libraries: ggplot2, dplyr, scales. Chart: time-series line chart with smoothing. Purpose: show changes in case-fatality ratio across time.​

**Trajectory of measles (deaths vs cases)** : Libraries: ggplot2, dplyr, scales, viridis. Chart: log–log phase-space scatter/trajectory with year color gradient. Purpose: show how deaths and cases jointly evolved over time.​

## 5.Results {#results}

## 5.1 Historical Analysis 1900–2000

```{r}
library(ggplot2)
library(dplyr)
library(lubridate)
library(scales)
library(maps)
library(patchwork)
library(viridis)
library(ggrepel)
```

```{r}

# Read the CSV file
data <- read.csv("measles_data.csv", stringsAsFactors = FALSE)

# Convert from_date to Date format and extract year
data$from_date <- as.Date(data$from_date)
data$year <- year(data$from_date)

# Aggregate cases by year and convert to millions
yearly_cases <- data %>%
  group_by(year) %>%
  summarise(total_cases = sum(number, na.rm = TRUE)) %>%
  mutate(total_cases_millions = total_cases / 1000000)

# Create the plot with millions scaling
ggplot(yearly_cases, aes(x = year, y = total_cases_millions)) +
  geom_line(color = "steelblue", size = 1) +
 # geom_point(color = "darkblue", size = 2) +
  scale_y_continuous(labels = label_number(accuracy = 0.01, suffix = "M")) +
  labs(title = "Measles Cases Over Time",
       x = "Year",
       y = "Number of Cases (Millions)") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
        axis.text = element_text(size = 10),
        axis.title = element_text(size = 12))

# Optional: Save the plot
ggsave("measles_cases_by_year.png", width = 10, height = 6, dpi = 300)

# Print summary statistics
print(yearly_cases)

```

**Fig 1: Annual measles cases (1900–2000)**

The annual measles time series from 1900 to 2000 reveals three distinct phases in the disease trajectory in the United States. Before vaccine introduction in 1963, reported measles incidence remained persistently high, with many years exceeding hundreds of thousands to more than a million cases, reflecting sustained endemic transmission in a largely susceptible population. These early decades are characterised by large, recurrent epidemic peaks and only brief, shallow troughs, indicating that measles circulated efficiently and rapidly replenished its new infections. Following the introduction of measles vaccination in 1963, the curve shows a sharp and sustained decline, with annual case counts dropping by orders of magnitude over the subsequent decades. This steep downward trend illustrates the impact of increasing vaccine coverage and the gradual interruption of widespread transmission chains, as fewer susceptible individuals remained available to fuel large outbreaks. By the late 1990s, the time series approaches zero, marking the elimination phase when endemic circulation was interrupted and most reported cases were sporadic or imported.​ The tail of the time series nonetheless highlights a minor resurgence phase, with small but distinct spikes around the late 1980s and early 1990s. These localised outbreaks, occurring against a backdrop of very low national incidence, demonstrate that even in the elimination phase, regions with low vaccination coverage can allow measles to re-emerge. Overall, this figure summarises the transition from a pre‑vaccine phase of large, regular epidemics to a post‑vaccine phase of greatly reduced incidence followed by occasional resurgences when vaccination gaps appeared.​

## 5.2 Pre and Post vaccination Era.

```{r}
  # install.packages("patchwork")

# Read data
data <- read.csv("measles_data.csv", stringsAsFactors = FALSE)
data$from_date <- as.Date(data$from_date)
data$year      <- year(data$from_date)

# State map + mapping
states_map <- map_data("state")
state_mapping <- data.frame(
  state  = state.abb,
  region = tolower(state.name)
)

# Helper: aggregate by state for a given filter
agg_by_state <- function(df) {
  df %>%
    group_by(state) %>%
    summarise(total_cases = sum(number, na.rm = TRUE), .groups = "drop") %>%
    mutate(total_cases_millions = total_cases / 1e6) %>%
    left_join(state_mapping, by = "state")
}

# Before / after datasets
state_cases_before <- agg_by_state(filter(data, year < 1963))
state_cases_after  <- agg_by_state(filter(data, year >= 1963))

# Join with map data
choropleth_data_before <- states_map %>%
  left_join(state_cases_before, by = "region")

choropleth_data_after <- states_map %>%
  left_join(state_cases_after, by = "region")

# Common max for shared scale
max_common <- max(
  state_cases_before$total_cases_millions,
  state_cases_after$total_cases_millions,
  na.rm = TRUE
)

fill_scale <- scale_fill_gradientn(
  colors = c("#FFFFFF", "#FFF7E6", "#FFE5CC", "#FFD1A3", "#FFAD5C", 
             "#FF8C42", "#FF6B2B", "#FF4500", "#E63900", "#CC3300", "#990000"),
  name   = "Total cases\n(Millions)",
  na.value = "grey95",
  values = scales::rescale(c(0, 0.01, 0.05, 0.1, 0.2, 0.3, 0.5, 0.7, 0.85, 0.95, 1)),
  limits = c(0, max_common),
  labels = label_number(accuracy = 0.01),
  guide = guide_colorbar(
    direction     = "vertical",          # vertical legend
    barheight     = unit(3, "cm"),
    barwidth      = unit(0.4, "cm"),
    title.position = "right",            # put title on the side
    title.vjust    = 0.5                 # center along the bar
  )
)

base_theme <- theme_void() +
  theme(
    legend.position = "right",
    legend.title = element_text(
      size = 8,
      face = "bold",
      angle = 90,            # rotate title so text is vertical
      vjust = 0.5
    ),
    legend.text  = element_text(size = 7),
    plot.background   = element_rect(fill = "#f7f7f7", color = NA),
    panel.background  = element_rect(fill = "#f7f7f7", color = NA),
    plot.title    = element_text(hjust = 0.5, size = 11, face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, size = 9)
  )

map_before <- ggplot(choropleth_data_before,
                     aes(x = long, y = lat, group = group, fill = total_cases_millions)) +
  geom_polygon(color = "white", linewidth = 0.3) +
  fill_scale +
  labs(
    title = "Before 1963",
    subtitle = "Pre‑vaccine era"
  ) +
  coord_map("albers", lat0 = 39, lat1 = 45) +
  base_theme

map_after <- ggplot(choropleth_data_after,
                    aes(x = long, y = lat, group = group, fill = total_cases_millions)) +
  geom_polygon(color = "white", linewidth = 0.3) +
  fill_scale +
  labs(
    title = "1963 and later",
    subtitle = "Post‑vaccine era"
  ) +
  coord_map("albers", lat0 = 39, lat1 = 45) +
  base_theme

# Side‑by‑side with shared legend
combined <- map_before + map_after + plot_layout(ncol = 2, guides = "collect") &
  theme(legend.position = "right")

combined

# Save smaller, landscape image
ggsave("measles_before_after_side_by_side.png",
       plot = combined,
       width = 5, height = 25, dpi = 300)

```

**Fig 2: State‑level burden before and after 1963**

The choropleth map shows the total number of measles cases recorded in each US state before and after 1963, providing a spatial perspective on disease burden, before and after vaccine. Several states show cumulative totals in the order of millions of cases, and large contiguous regions appear in the darkest shades of the colour scale, indicating very high historical incidence. This pattern underscores how widespread and intense measles transmission was in the pre‑vaccine era, particularly in highly populated states and those with major urban centres where high population facilitated spread of infection.​ It also shows cumulative measles cases for the period after 1963, using the same or a comparable colour scale to allow direct visual comparison. Here, the overall intensity is dramatically reduced, states that previously recorded totals above two million cases now fall into much lighter bands, often with cumulative counts reduced by more than an order of magnitude into the range of tens to a few hundred thousand. Large areas of the map appear in the lightest colours, indicating that many states recorded relatively few cases over the entire post vaccination period. Taken together, these choropleth maps clearly visualise the impact of vaccination at the spatial level. They show that the reduction in measles burden was not confined to a few states but occurred across the country, but with some variation in the magnitude of decline. States that had been among the highest burden regions before 1963 still tend to have relatively higher totals afterwards, but the absolute numbers are much smaller, reflecting both the effectiveness of the vaccine and the importance of sustained nationwide coverage.​

```{r}

# Read the measles data
measles_df <- read.csv("measles_data.csv")

# Extract year from the 'from_date' column and prepare data
measles_df$year <- as.numeric(substr(measles_df$from_date, 1, 4))
measles_df$loc <- measles_df$state

# Summarize the data (1950-1980, excluding AK and HI)
heatmap_df <- measles_df %>%
  filter(year >= 1950 & year <= 1980) %>%
  filter(!loc %in% c("AK", "HI")) %>%
  group_by(loc, year) %>%
  summarise(incidence = sum(number, na.rm = TRUE), .groups = "drop")

# Compute total incidence per state and get top 20
top_20_states <- heatmap_df %>%
  group_by(loc) %>%
  summarise(total_incidence = sum(incidence, na.rm = TRUE)) %>%
  arrange(desc(total_incidence)) %>%
  head(20) %>%
  pull(loc)

# Filter data for top 20 states and reorder factor
heatmap_df <- heatmap_df %>%
  filter(loc %in% top_20_states) %>%
  mutate(loc = factor(loc, levels = top_20_states))

# Plot
ggplot(heatmap_df, aes(x = year, y = loc, fill = incidence)) +
  geom_tile(color = "white", linewidth = 0.1) +
  scale_fill_gradient(low = "lightblue", high = "darkred", name = "Cases", na.value = "grey90") +
  scale_x_continuous(breaks = seq(1950, 1980, by = 5)) +
  labs(
    title = "Measles Cases by State and Year (1950–1980) - Top 20 States",
    x = "Year",
    y = "State (ordered by total cases)"
  ) +
  theme_minimal(base_size = 13) +
  theme(axis.text.y = element_text(size = 7))

# To save with adjusted vertical space for 20 states:
# ggsave("measles_heatmap_top20.png", width = 12, height = 10, units = "in", dpi = 300)

```

**Fig 3: Heatmap of top 20 states (1950–1980)**

This heat map focuses on the top 20 US states with the highest cumulative measles incidence between 1950 and 1980 and visualizes their yearly case counts over this period. Each cell represents the number of measles cases in a particular state and year, with a color gradient running from light shades for low counts to dark shades for very high counts. This design allows temporal trends and cross state differences to be examined simultaneously in a compact format.​ For most of the top 20 states, such as Texas, New York, California, Wisconsin, New Jersy etc. rows corresponding to the early 1950s and early 1960s contain multiple dark cells, reflecting repeated years of high measles incidence before widespread vaccination. These states often show contiguous blocks of high intensity, indicating that high transmission was sustained over consecutive years rather than being restricted to isolated spikes. After 1963, with the introduction of measles vaccine, there is a tremendous shift towards lighter colors across many states, signalling a substantial reduction in annual case counts.​ The heat map thus makes the timing and magnitude of change very clear, a broad band of dark shades in the pre‑vaccine and very early post‑vaccine years is followed by mostly lighter shades as measles is progressively brought under control. This pattern supports the interpretation that vaccination did not just reduce national total cases but also lowered incidence in traditionally high burden states to levels that would have been atypically low in the pre vaccine phase. The map also helps identify states that remained relatively high burden for longer or experienced late declines, which could be linked to differences in population size, local policies or vaccine uptake.​

```{r}

# 1. Read the measles data --------------
measles_df <- read.csv("measles_data.csv", stringsAsFactors = FALSE)

# Ensure date column is Date
measles_df$from_date <- as.Date(measles_df$from_date)

# 2. Create month and season -----------------
measles_df <- measles_df %>%
  mutate(
    month = month(from_date),
    season = case_when(
      month %in% c(12, 1, 2) ~ "Winter",
      month %in% c(3, 4, 5) ~ "Spring",
      month %in% c(6, 7, 8) ~ "Summer",
      month %in% c(9, 10, 11) ~ "Fall"
    )
  )

# 3. Build season_summary with mean, SD, SE, CI ------------------------------
season_summary <- measles_df %>%
  group_by(season) %>%
  summarise(
    avg_cases    = mean(number, na.rm = TRUE),
    median_cases = median(number, na.rm = TRUE),
    sd_cases     = sd(number, na.rm = TRUE),
    n            = n(),
    se           = sd_cases / sqrt(n),
    ci_lower     = avg_cases - 1.96 * se,
    ci_upper     = avg_cases + 1.96 * se,
    .groups      = "drop"
  )

# Order seasons
season_summary$season <- factor(
  season_summary$season,
  levels = c("Winter", "Spring", "Summer", "Fall")
)

# 4. Beautiful bar chart of seasonal averages with 95% CI --------------------
p <- ggplot(season_summary, aes(x = season, y = avg_cases)) +
  geom_errorbar(aes(ymin = ci_lower, ymax = ci_upper),
                width = 0.25,
                linewidth = 0.7,
                color = "#2C3E50") +
  geom_col(aes(fill = season),
           width = 0.6,
           color = "white") +
  scale_fill_viridis_d(option = "C", end = 0.9, direction = 1) +
  geom_text(aes(label = comma(round(avg_cases, 0))),
            vjust = -0.5,
            size = 3.8,
            fontface = "bold",
            color = "gray20") +
  labs(
    title = "Seasonal Distribution of Measles Cases",
    subtitle = "Average cases per season with 95% confidence intervals",
    x = NULL,
    y = "Average Number of Cases",
    fill = NULL,
    caption = "Error bars show 95% confidence intervals"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(hjust = 0.5, size = 16, face = "bold",
                              margin = margin(b = 5)),
    plot.subtitle = element_text(hjust = 0.5, size = 11, color = "gray40",
                                 margin = margin(b = 10)),
    plot.caption = element_text(size = 9, color = "gray50", hjust = 0),
    axis.text.x = element_text(size = 12, face = "bold"),
    axis.text.y = element_text(size = 11),
    axis.title.y = element_text(size = 12, face = "bold",
                                margin = margin(r = 10)),
    panel.grid.major.x = element_blank(),
    panel.grid.minor = element_blank(),
    panel.grid.major.y = element_line(color = "gray90", linetype = "dashed"),
    plot.margin = margin(15, 15, 15, 15),
    legend.position = "none"
  ) +
  scale_y_continuous(labels = comma,
                     expand = expansion(mult = c(0.05, 0.15)))

print(p)

ggsave("measles_seasonal_bar.png", plot = p,
       width = 10, height = 6, dpi = 300)
```

**Fig 4: Seasonal distribution of measles cases**

This bar chart summarizes the distribution of measles cases across the four seasons winter, spring, summer and fall, aggregated over the study period. The plot shows that spring has the highest average number of cases, followed by winter, with summer considerably lower and fall having the lowest burden of the four seasons. This ranking is robust across the period analysed, indicating a consistent seasonal pattern in measles transmission.​ The prominence of spring suggests that measles tends to peak in late winter and early spring, a pattern consistent with school driven cases and environmental factors that favor respiratory virus transmission. Winter, which precedes spring, also shows elevated average counts, reflecting the build‑up of cases leading into the main seasonal peak in early spring. By contrast, summer and fall have markedly lower average counts, implying that transmission slows down when schools are closed and when weather is not very favorable for the virus transmission, reducing effective contact rates.​ By aggregating over many years, this plot demonstrates that seasonal case trends is a persistent feature of measles epidemiology rather than a transient or period specific phenomenon. The clear dominance of spring cases has important implications for the timing of vaccination and outbreak preparedness, since it indicates when healthcare systems and public health authorities are likely to face the greatest pressure from measles admissions and control activities.​

```{r}

# Read the CSV file containing measles data into a data frame
measles_df <- read.csv("measles_data.csv")

# Convert the 'from_date' column from text/character format to actual Date objects
measles_df$from_date <- as.Date(measles_df$from_date)

# Extract month number (1-12) from the date and add it as a new column
measles_df$month <- month(measles_df$from_date)

# Calculate total cases for each month across all years
monthly_trend <- measles_df %>%
  # Remove any rows where month is missing (NA values)
  dplyr::filter(!is.na(month)) %>%
  # Group all rows by their month number
  group_by(month) %>%
  # For each month, sum up all the cases from all years
  summarise(total_cases = sum(number, na.rm = TRUE), .groups = "drop")


# Create an enhanced version with color gradient based on case counts
ggplot(monthly_trend, aes(x = factor(month), y = total_cases, fill = total_cases)) +
  # Create bars with fill color varying by case count
  geom_bar(stat = "identity",           # Use actual y values
           color = "white",             # White border around each bar
           size = 0.5) +                # Thin border line
  # Convert to polar coordinates
  coord_polar() +
  # Use a color gradient from light yellow (low) to dark red (high)
  scale_fill_gradient(low = "lightyellow", 
                      high = "darkred",
                      name = "Total Cases",           # Legend title
                      labels = comma) +               # Format legend numbers with commas
  # Add titles and labels
  labs(
    title = "Seasonal Pattern of Measles Cases by Month",
    subtitle = "Total cases aggregated across all years | Color intensity shows case volume",
    x = "Month (1 = Jan, 12 = Dec)",
    y = "Total Cases"
  ) +
  # Use minimal theme
  theme_minimal(base_size = 12) +
  # Customize appearance
  theme(
    # Center and style the title
    plot.title = element_text(hjust = 0.5, size = 16, face = "bold", 
                              margin = margin(b = 5)),
    # Center and style the subtitle
    plot.subtitle = element_text(hjust = 0.5, size = 10, color = "gray40",
                                 margin = margin(b = 15)),
    # Bold month labels
    axis.text.x = element_text(face = "bold", size = 10),
    # Format y-axis labels
    axis.text.y = element_text(size = 9),
    # Position legend at the bottom
    legend.position = "bottom",
    # Make legend horizontal
    legend.direction = "horizontal",
    # Set legend width
    legend.key.width = unit(2, "cm")
  ) +
  # Format y-axis with commas
  scale_y_continuous(labels = comma)

# Save the enhanced polar chart
ggsave("measles_seasonal_polar_gradient.png", 
       width = 11,        # Slightly wider for legend
       height = 11,       # Square dimensions
       dpi = 300)         # High resolution

# Print monthly statistics
print(monthly_trend)

```

**Fig 5: Monthly pattern of measles incidence**

This plot shows a more granular view of seasonality by plotting total measles cases for each calendar month, from January to December, across all years. In this visual, months are arranged around the circle and represented by bars whose height and color intensity reflect the total number of cases recorded in that month over the entire data set. The resulting pattern shows that March, April and May have the highest total cases, forming a clear cluster of peak months in late winter and spring.​ These months correspond exactly to the season that had the highest burden in the previous plot, but here it pinpoints the specific months within spring that carry most of the measles load. The fact that March, April and May stand out so distinctly suggests that measles outbreaks often accelerate in late winter, peak during early to mid spring and then decline as summer approaches. Months in summer and fall, such as July, August or October, show much lower total cases, which visually appear as shorter, lighter bars on the plot.​ By combining circular layout with a continuous colour gradient, this figure reinforces the idea of measles as a seasonally patterned disease with a strong and recurring spring peak. It also illustrates how the monthly distribution of cases is tightly concentrated in a few months, which helps explain why annual and seasonal aggregates are so dominated by the trends of late winter and spring. For public health planning, this kind of monthly profile is particularly useful for scheduling interventions, anticipating healthcare demand and interpreting surveillance signals in different periods of the year.​

```{r}

measles_df <- read.csv("measles_data.csv")

# Extract year from the 'from_date' column
measles_df$year <- as.numeric(substr(measles_df$from_date, 1, 4))

# Summarize measles cases by state and year (1950-1990)
summary_df <- measles_df %>%
  filter(year >= 1950 & year <= 1990) %>%
  group_by(state, year) %>%
  summarise(total_cases = sum(number, na.rm = TRUE), .groups = "drop") %>%
  rename(loc = state)

# Get US state map data from the maps package
states_map <- map_data("state")

# Create a lookup table to match state abbreviations to full names (lowercase)
state_names <- data.frame(
  loc = state.abb,                              # State abbreviations (AK, AL, AR, etc.)
  region = tolower(state.name),                 # State full names in lowercase
  stringsAsFactors = FALSE
)

# Add DC manually if needed
state_names <- rbind(state_names, data.frame(loc = "DC", region = "district of columbia"))

# Join state names to summary data
summary_df <- summary_df %>%
  left_join(state_names, by = "loc")

# Create a complete grid of all states × years
all_years <- 1950:1990                         # Range of years to analyze
all_regions <- unique(states_map$region)       # All state regions from map data

complete_grid <- expand.grid(region = all_regions, year = all_years, stringsAsFactors = FALSE)

# Join summarized data into the complete grid
summary_df_complete <- complete_grid %>%
  left_join(summary_df, by = c("region", "year"))

# Join with the spatial map data
map_df_complete <- left_join(states_map, summary_df_complete, by = "region")

# Filter for specific years to avoid too many panels (every 5 years)
selected_years <- seq(1950, 1990, by = 5)      # Years: 1950, 1955, 1960, ..., 1990

ggplot(data = filter(map_df_complete, year %in% selected_years)) +
  # Draw the map with fill color based on total cases
  geom_polygon(aes(x = long, y = lat, group = group, fill = total_cases), 
               color = "white",                 # White borders between states
               size = 0.2) +                    # Thin border lines
  # Use gradient color scheme from light yellow to dark red
  scale_fill_gradient(
    low = "lightyellow",                        # Color for low case counts
    high = "darkred",                           # Color for high case counts
    na.value = "gray90",                        # Gray for missing data
    name = "Total Cases",                       # Legend title
    labels = scales::comma                      # Format numbers with commas
  ) +
  # Create separate panel for each year
  facet_wrap(~ year, ncol = 3) +               # 3 columns of maps
  # Add titles and labels
  labs(
    title = "Measles Cases by State (1950–1990)",
    subtitle = "Snapshot every 5 years"
  ) +
  # Equal aspect ratio so map isn't distorted
  coord_fixed(1.3) +                            # 1.3 ratio works well for US map
  # Use minimal theme
  theme_minimal() +
  theme(
    # Remove axis text and ticks (not needed for maps)
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    axis.title = element_blank(),
    # Style the title
    plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
    plot.subtitle = element_text(size = 11, color = "gray40", hjust = 0.5),
    # Style facet labels (year labels)
    strip.text = element_text(size = 11, face = "bold"),
    # Remove grid lines
    panel.grid = element_blank()
  )

# Save the faceted map
ggsave("measles_map_faceted.png", width = 14, height = 12, dpi = 300)

```

**Fig 6: Snapshot maps every 5 years (1950–1990)**

This figure shows faceted choropleth maps of measles cases by state for selected years between 1950 and 1990, with one map every five years. In the early panels (1950s and early 1960s), many states appear in dark shades, indicating widespread high incidence in the pre‑vaccine phase.

As the panels progress into the late 1960s and 1970s, the maps become progressively lighter, reflecting the substantial national decline in measles following vaccine introduction. By the 1980s, most states show only low levels of reported cases, and the absence of large dark clusters illustrates how widespread transmission was gradually interrupted, even though isolated pockets of higher incidence still appear in some years.​

```{r}

# Read the measles data
measles_df <- read.csv("measles_data.csv")

# Convert from_date to Date format and extract year
measles_df$from_date <- as.Date(measles_df$from_date)
measles_df$year <- year(measles_df$from_date)

# Aggregate cases by year for the period 1960-2000
yearly_cases <- measles_df %>%
  filter(year >= 1960 & year <= 2000) %>%             # Filter years 1960-2000
  group_by(year) %>%                                   # Group by year
  summarise(total_cases = sum(number, na.rm = TRUE),  # Sum all cases per year
            .groups = "drop")

# Find the max value for positioning
max_cases <- max(yearly_cases$total_cases, na.rm = TRUE)

# Create minimalistic plot
ggplot(yearly_cases, aes(x = year, y = total_cases)) +
  # Shaded background for resurgence (1989-1991)
  annotate("rect",                                     
           xmin = 1989, xmax = 1991,                   
           ymin = 0, ymax = Inf,                       
           alpha = 0.12,                               
           fill = "#E74C3C") +                         
  # Vaccine introduction marker (1963)
  geom_vline(xintercept = 1963,                        
             linetype = "dashed",                      
             color = "#27AE60",                        # Green for vaccine
             size = 0.8,                               
             alpha = 0.7) +                            
  annotate("text",                                     
           x = 1963, y = max_cases * 0.90,             
           label = "",                          
           size = 3.5,                                 
           color = "#27AE60",                          
           fontface = "bold",
           angle = 90,                                 # Vertical text
           vjust = -0.5) +                             
  # Elimination goal marker (1978)
  geom_vline(xintercept = 1978,                        
             linetype = "dashed",                      
             color = "#3498DB",                        # Blue for goal
             size = 0.8,                               
             alpha = 0.7) +                            
  annotate("text",                                     
           x = 1978, y = max_cases * 0.90,             
           label = "",                             
           size = 3.5,                                 
           color = "#3498DB",                          
           fontface = "bold",
           angle = 90,                                 
           vjust = -0.5) +                             
  # Resurgence label
  annotate("text",                                     
           x = 1990, y = max_cases * 0.95,             
           label = "",                       
           size = 3.5,                                 
           color = "#C0392B",                          
           fontface = "bold") +                        
  # Main line
  geom_line(color = "#2C3E50",                         
            size = 1.3) +                              
  # Area fill
  geom_area(fill = "#34495E",                          
            alpha = 0.2) +                             
  # Simple points
  geom_point(color = "#2C3E50",                        
             size = 1.8) +                             
  # Highlight resurgence years
  geom_point(data = filter(yearly_cases, year >= 1989 & year <= 1991),
             aes(x = year, y = total_cases),
             color = "#E74C3C",                        
             size = 3.5) +                             
  # Minimal axis formatting
  scale_y_continuous(labels = comma,                   
                     expand = expansion(mult = c(0, 0.08))) +
  scale_x_continuous(breaks = seq(1960, 2000, by = 10)) +
  # Minimal labels
  labs(
    title = "Measles Cases (1960–2000)",
    x = NULL,                                          # Remove x-axis label
    y = "Cases"                                        # Short y-axis label
  ) +
  # Clean minimal theme
  theme_minimal(base_size = 11) +
  theme(
    plot.title = element_text(hjust = 0.5,             
                              size = 14,               
                              face = "bold",
                              margin = margin(b = 20)),
    axis.title.y = element_text(size = 11, 
                                face = "bold",
                                margin = margin(r = 10)),
    axis.text = element_text(size = 10),
    panel.grid.minor = element_blank(),                
    panel.grid.major.x = element_blank(),              # Remove vertical grid
    panel.grid.major.y = element_line(color = "gray92",
                                      size = 0.3),     # Subtle horizontal grid
    plot.margin = margin(15, 15, 15, 15)               
  )

# Save the plot
ggsave("measles_resurgence_minimal.png", 
       width = 12,                                     
       height = 6,                                     
       dpi = 300)

# Print yearly data
print(yearly_cases)

```

**Fig 7: Measles cases 1960–2000 with vaccine and a small resurgence**

This plot, shows annual measles cases from 1960 to 2000 with key public health milestones marked on the time axis. The green dashed line at 1963 indicates vaccine introduction and is followed by a steep decline in yearly case counts, demonstrating the immediate impact of vaccination on national burden.

A blue dashed line around the elimination goal year points to the period when sustained interruption of endemic transmission became a . Despite the overall success showing downward trend. The red shaded region and highlighted points around 1989–1991 reveal a small resurgence, where cases temporarily increased again, emphasizing that even in the vaccine era, immunity gaps or drops in vaccine coverage can lead to substantial outbreaks.​

```{r}

# 1. Read measles data
measles_df <- read.csv("measles_data.csv")

# Ensure consistent city naming
measles_df$loc <- toupper(measles_df$loc)

# Add year and filter period 1950–1990
measles_df$from_date <- as.Date(measles_df$from_date)
measles_df$year <- year(measles_df$from_date)

measles_period <- measles_df %>%
  filter(year >= 1950 & year <= 1990)

# 2. Aggregate total cases per city over 1950–1990
city_cases <- measles_period %>%
  group_by(loc, state) %>%
  summarise(total_cases = sum(number, na.rm = TRUE), .groups = "drop")

# 3. City population lookup (example: 1960 census for major cities) [web:36][web:38]
city_pop <- tibble::tribble(
  ~loc,           ~state, ~population,
  "NEW YORK",     "NY",   7781984,
  "CHICAGO",      "IL",   3550404,
  "LOS ANGELES",  "CA",   2479015,
  "PHILADELPHIA", "PA",   2002512,
  "DETROIT",      "MI",   1670144,
  "BALTIMORE",    "MD",    939024,
  "BOSTON",       "MA",    697197,
  "CLEVELAND",    "OH",    914808,
  "ST. LOUIS",    "MO",    750026,
  "PITTSBURGH",   "PA",    604332
)

# 4. Join measles totals with population and keep top 10 by population
city_merged <- city_cases %>%
  inner_join(city_pop, by = c("loc", "state"))

top10 <- city_merged %>%
  arrange(desc(population)) %>%
  slice_head(n = 10)

# 5. Log–log scatterplot: population vs total cases (1950–1990)
ggplot(top10, aes(x = population, y = total_cases)) +
  geom_point(color = "#2C3E50", size = 3) +
  geom_smooth(method = "lm", se = FALSE,
              color = "#E74C3C", linewidth = 1) +
  geom_text_repel(aes(label = loc), size = 3, max.overlaps = 20) +
  scale_x_log10(labels = comma) +
  scale_y_log10(labels = comma) +
  labs(
    title = "Measles burden vs city size (top 10 US cities)",
    subtitle = "Total measles cases, 1950–1990, vs 1960 census population (log–log)",
    x = "City population (log scale)",
    y = "Total measles cases, 1950–1990 (log scale)"
  ) +
  theme_minimal(base_size = 11) +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank()
  )

```

**Fig 8: Measles burden vs city population (top 10 cities)**

Fig 8 plots total measles cases from 1950–1990 against city population for the ten largest U.S. cities on log–log axes, with a fitted regression line summarizing the overall relationship. Most cities lie close to this line, indicating that larger populations are associated with greater cumulative measles burden, consistent with higher contact rates and a larger pool of susceptible sustaining repeated outbreaks.

Cities that appear above the line experienced more measles than expected for their size, suggesting denser transmission conditions or lower effective vaccination coverage, whereas those below the line had fewer cases than predicted, potentially reflecting better control or differences in surveillance.​

```{r}

measles_df <- read.csv("measles_data.csv")
measles_df$from_date <- as.Date(measles_df$from_date)
measles_df$year <- year(measles_df$from_date)

# 20-year window around vaccine licensure (1963)
yearly <- measles_df %>%
  filter(year >= 1953, year <= 1972) %>%
  group_by(year) %>%
  summarise(total_cases = sum(number, na.rm = TRUE), .groups = "drop") %>%
  mutate(period = if_else(year < 1963, "Pre‑vaccine", "Post‑vaccine"))

ggplot(yearly, aes(x = factor(year), y = total_cases, fill = period)) +
  geom_col(width = 0.8) +
  scale_y_continuous(labels = comma) +
  scale_fill_manual(values = c("Pre‑vaccine" = "#C0392B",   # red
                               "Post‑vaccine" = "#27AE60") # green
  ) +
  geom_vline(xintercept = which(levels(factor(yearly$year)) == "1963"),
             linetype = "dashed", color = "gray30") +
  labs(
    title = "Measles cases in the US, 10 years before and after the 1963 vaccine",
    x = NULL,
    y = "Total reported cases",
    fill = NULL
  ) +
  theme_minimal(base_size = 11) +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),
    axis.text.x = element_text(angle = 60, hjust = 1),
    legend.position = "top"
  )
```

**Fig 9: Measles cases 10 years before and after vaccine introduction**

This bar chart compares annual measles cases in a 20 year window spanning ten years before and ten years after the 1963 vaccine introduction, with years colored in dark red as pre vaccine phase and years colored in green as post vaccine phase.

In the pre vaccine decade, most bars are high, reflecting large and recurring epidemics and indicating that measles remained fully endemic during this period. In the decade after 1963, bar heights drop sharply overall, showing that reported cases fell by roughly an order of magnitude in many years as vaccination coverage rose and transmission was stopped. The remaining relatively tall bars in some post vaccine years highlight that residual transmission and occasional spikes still occurred until high coverage and consistent control measures were firmly established.​

```{r}


# 1. Read and prepare data
measles_df <- read.csv("measles_data.csv")

measles_df$from_date <- as.Date(measles_df$from_date)
measles_df$year      <- year(measles_df$from_date)
measles_df$loc       <- toupper(measles_df$loc)

# 2. Choose 20-year window and a single city
start_year <- 1950
end_year   <- 1969          # 20 years: 1950–1969
target_city <- "NEW YORK"   # change to the city you want

city_20yrs <- measles_df %>%
  filter(year >= start_year,
         year <= end_year,
         loc == target_city)

# 3. Aggregate to city-year totals
city_year <- city_20yrs %>%
  group_by(year) %>%
  summarise(total_cases = sum(number, na.rm = TRUE), .groups = "drop")

# 4. Compute mean, sd, and z-score across the 20 years
city_year_z <- city_year %>%
  mutate(
    mean_city = mean(total_cases, na.rm = TRUE),
    sd_city   = sd(total_cases,   na.rm = TRUE),
    z_score   = ifelse(sd_city > 0,
                       (total_cases - mean_city) / sd_city,
                       0)
  )

# 5. Keep the 10 most anomalous years (highest z-scores)
city_year_top10 <- city_year_z %>%
  slice_max(order_by = z_score, n = 10, with_ties = FALSE) %>%
  arrange(year) %>%
  mutate(anomaly = z_score >= 2)

# 6. Bar chart of z-scores for those 10 years
ggplot(city_year_top10,
       aes(x = factor(year),
           y = z_score,
           fill = anomaly)) +
  geom_col(width = 0.8) +
  scale_fill_manual(
    values = c(`FALSE` = "#3498DB",    # blue: elevated but not extreme
               `TRUE`  = "#E74C3C"),   # red: strong anomalies (z >= 2)
    labels = c("Peak year", "Strong anomaly (z ≥ 2)"),
    name   = NULL
  ) +
  geom_hline(yintercept = 2, linetype = "dashed",
             color = "grey40", linewidth = 0.5) +
  labs(
    title = paste0("Most anomalous measles years in ", target_city,
                   " (", start_year, "–", end_year, ")"),
    subtitle = "Top 10 years by z-score; red bars indicate z ≥ 2",
    x = "Year",
    y = "Z-score (standardized cases)"
  ) +
  theme_minimal(base_size = 11) +
  theme(
    plot.title    = element_text(hjust = 0.5, face = "bold"),
    plot.subtitle = element_text(hjust = 0.5),
    axis.text.x   = element_text(angle = 60, hjust = 1)
  )

```

**Fig 10: Most anomalous measles years in a single city (z‑scores)**

This figure, displays the ten most anomalous measles years over a 20‑year window, using z‑scores of annual cases counts to standardize against previous years case numbers. Each bar represents a year’s z‑score and years with z-score greater than 2 are highlighted as strong anomalies indicating incidence more than two standard deviations above the long-term mean.

The concentration of high z‑score bars in specific periods suggests that localized outbreaks or conditions favoring transmission occurred in that year. Here year 1952 standing out clearly from the usual fluctuation and signalling that warrants closer epidemiological scrutiny.​

```{r}
# data ref : https://ourworldindata.org/grapher/measles-cases-and-death?time=1935..1990&overlay=download-data

# Read data
df <- read.csv("measles-cases-and-death.csv", stringsAsFactors = FALSE)

df <- df %>%
  filter(!is.na(Year),
         !is.na(Reported.measles.cases),
         !is.na(Measles.deaths)) %>%
  filter(Year >= 1919, Year <= 1990) %>%
  mutate(
    CFR = ifelse(Reported.measles.cases > 0,
                 Measles.deaths / Reported.measles.cases,
                 NA_real_)
  )

p_cfr <- ggplot(df, aes(x = Year, y = CFR)) +
  geom_line(color = "#2C3E50", linewidth = 0.8) +
  geom_point(color = "#2C3E50", size = 1.8) +
  geom_smooth(se = TRUE,
              color = "#27AE60",
              fill  = "#27AE60",
              alpha = 0.18,
              linewidth = 1) +
  scale_y_continuous(labels = percent_format(accuracy = 0.01),
                     expand  = expansion(mult = c(0, 0.05))) +
  scale_x_continuous(breaks = seq(min(df$Year), max(df$Year), by = 5)) +
  labs(
    title    = "Measles case‑fatality ratio (CFR) over time – United States",
    subtitle = "CFR = deaths / reported cases, by year",
    x        = "Year",
    y        = "Case‑fatality ratio"
  ) +
  theme_minimal(base_size = 11) +
  theme(
    plot.title    = element_text(hjust = 0.5, face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, colour = "grey40"),
    axis.text.x   = element_text(angle = 60, hjust = 1),
    panel.grid.minor = element_blank()
  )

p_cfr

```

**Fig 11: Measles case‑fatality ratio (CFR) over time**

This plot shows the annual measles case‑fatality ratio in the United States, calculated as deaths divided by reported cases and plotted with a smoothed trend. The overall downward trajectory indicates that, over the decades, the risk of dying given a reported measles infection substantially decreased, reflecting improvements in clinical care, nutrition, general living conditions and possibly surveillance sensitivity.

Short term fluctuations and minor peaks in the CFR curve suggest periods in which severity briefly worsened or reporting changed, but these are superimposed on a clear long term decline, illustrating how measles became progressively less lethal even as incidence itself was falling due to vaccination.​

```{r}

# Read data
df <- read.csv("measles-cases-and-death.csv", stringsAsFactors = FALSE)

df <- df %>%
  filter(!is.na(Year),
         !is.na(Reported.measles.cases),
         !is.na(Measles.deaths)) %>%
  filter(Year >= 1919, Year <= 1990)

p_phase <- ggplot(df,
                  aes(x = Reported.measles.cases,
                      y = Measles.deaths)) +
  geom_path(color = "#34495E", linewidth = 0.9, alpha = 0.8) +
  geom_point(aes(color = Year), size = 2) +
  scale_x_log10(labels = comma) +
  scale_y_log10(labels = comma) +
  scale_color_viridis_c(option = "C") +
  labs(
    title    = "Trajectory of measles in the United States",
    subtitle = "Annual deaths vs reported cases (log–log), coloured by year",
    x        = "Reported measles cases (log scale)",
    y        = "Measles deaths (log scale)",
    color    = "Year"
  ) +
  theme_minimal(base_size = 11) +
  theme(
    plot.title    = element_text(hjust = 0.5, face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, colour = "grey40"),
    panel.grid.minor = element_blank()
  )

p_phase
```

**Fig 12: Trajectory of measles deaths vs cases**

This visualization plots annual measles deaths against reported cases on log–log axes, connecting points in chronological order and coloring them by year to show the trajectory through time. Early years cluster in the upper‑right part of the plot, where both case counts and deaths are high, representing the pre‑vaccine phase of frequent, severe epidemics.

Over subsequent decades, the trajectory moves steadily towards the lower‑left, indicating simultaneous declines in incidence and mortality as vaccination, healthcare and living conditions improved. Sections where the path drops more vertically suggest reductions in deaths faster than in cases which indicates declining severity of disease, while segments slanting diagonally downwards show periods of comprehensive progress in reducing both measles cases and deaths in the United States.​

## 6.Discussion and limitations {#discussion-and-limitations}

The combination of temporal, spatial, seasonal and severity analysis presented in this project offers a comprehensive view of measles dynamics in the United States. National time series and pre and post vaccine comparisons confirm that measles burden declined dramatically after vaccination, although the presence of resurgences illustrates that high coverage and sustained public health efforts were necessary to move from control to elimination.​ State level maps and heat maps demonstrate marked spatial heterogeneity in measles burden. States with large populations and major urban centers consistently show higher incidence, reflecting both demographic factors and the role of dense contact networks in sustaining transmission. The changes observed between pre‑ and post‑vaccine maps suggest that vaccination efforts reduced burden across the country but did not erase underlying geographic differences.​ Seasonal and monthly analysis highlight strong within‑year structure, with clear peak seasons in which average case counts are substantially higher than in quieter periods. These patterns are consistent with known drivers of measles seasonality, such as school terms and environmental conditions, and underscore why timing of vaccination campaigns matters for outbreak prevention.​ City level analysis indicate a positive relationship between city size and measles burden, as expected for a directly transmitted infection with higher opportunities for contact in larger populations. The z‑score‑based anomaly detection approach provides a simple but effective way to flag years of exceptional activity, which could reflect local outbreaks, changes in reporting or special events.​ Severity analysis based on deaths and CFR suggest an overall decline in the risk of death given a reported case over time, reflecting improvements in health care and general living conditions alongside vaccination. The log–log trajectory of deaths versus cases provides a compact visual summary of this shift, showing how the combined burden moved towards lower incidence and mortality.​ Several limitations should be kept in mind when interpreting these results. First, the analysis are descriptive and do not incorporate mechanistic modelling or adjustment for confounders such as population growth, age structure or vaccination coverage levels. Second, the data-sets reflect reported cases and deaths, which may be subject to under reporting, classifications and changes in surveillance practices over time. Third, city population figures are approximate snapshots and do not capture changes in population size over the entire analysis period.​ Despite these limitations, the project demonstrates how thoughtfully designed visualizations can transform complex historical surveillance data into accessible insights. The R Markdown workflow ensures that all figures are directly linked to code and can be updated or extended as needed, making this a flexible template for similar analyses of other infectious diseases.​

## 7.Conclusion {#conclusion}

This project applied a broad range of data‑visualization techniques to historical measles data from the United States to explore temporal trends, spatial patterns, seasonal patterns and severity. By aggregating and transforming the data at multiple scales and presenting them through time‑series plots, maps, heat maps, circular charts and log–log trajectories, the analysis built a coherent narrative of measles dynamics in the pre‑vaccine and post‑vaccine phases.​ These findings emphasis the profound impact of vaccination on measles burden while illustrating that control and elimination required sustained efforts beyond initial vaccine introduction. They also show that spatial heterogeneity, strong seasonality and variation in severity are important features of measles epidemiology that can be effectively communicated through appropriate visualizations.​

## Literature {#literature}

```         
1. van Panhuis WG, Grefenstette J, Jung SY, et al. Contagious Diseases in the United States from 1888 to the Present. New England Journal of Medicine. 2013;369(22):2152-2158. doi:10.1056/NEJMms1215400

2. Project Tycho Level 2 data: Counts of multiple diseases reported in UNITED STATES OF AMERICA, 1888-2014. Zenodo. 2024. doi:10.5281/zenodo.12608994

3. Majumder MS, Cohn EL, Mekaru SR, Huston JE, Brownstein JS. Project Tycho 2.0: a repository to improve the integration and reuse of data for global population health. Journal of the American Medical Informatics Association. 2018;25(12):1608-1617. doi:10.1093/jamia/ocy121

4. Conis E. Measles and the Modern History of Vaccination. Public Health Reports. 2019;134(2):118-125. doi:10.1177/0033354918825154

5. Centers for Disease Control and Prevention. History of Measles.
Updated May 19, 2024. Accessed November 2, 2025. https://www.cdc.gov/measles/about/history.html

6. Patel M, Lee AD, Redd SB, et al. Increase in Measles Cases — United States, January 1–April 26, 2019. MMWR Morbidity and Mortality Weekly Report. 2019;68(17):402-404.

7. Hinman AR, Orenstein WA, Bloch AB, et al. Impact of measles in the United States. Reviews of Infectious Diseases. 1983;5(3):439-444. doi:10.1093/clinids/5.3.439

8. Orenstein WA, Papania M, Wharton ME. Measles elimination in the United States. Journal of Infectious Diseases. 2004;189(Suppl 1):S1-S3. doi:10.1086/377693

9. Gastañaduy PA, Budd J, Fisher N, et al. A Measles Outbreak in an Underimmunized Amish Community in Ohio. New England Journal of Medicine. 2016;375:1343-1354. doi:10.1056/NEJMoa1602295

10. Clemmons NS, Gastanaduy PA, Fiebelkorn AP, Redd SB, Wallace GS. Measles — United States, January 4–April 2, 2015. MMWR Morbidity and Mortality Weekly Report. 2015;64(14):373-376.

11. Zipprich J, Winter K, Hacker J, Xia D, Watt J, Harriman K. Measles Outbreak — California, December 2014–February 2015. MMWR Morbidity and Mortality Weekly Report. 2015;64(6):153-154.

12. Parker Fiebelkorn A, Redd SB, Gallagher K, et al. Measles in the United States during the Postelimination Era. Journal of Infectious Diseases. 2010;202(10):1520-1528. doi:10.1086/656914

13. Phadke VK, Bednarczyk RA, Salmon DA, Omer SB. Association Between Vaccine Refusal and Vaccine-Preventable Diseases in the United States: A Review of Measles and Pertussis. JAMA. 2016;315(11):1149-1158. doi:10.1001/jama.2016.1353

14. Enders JF, Peebles TC. Propagation in tissue cultures of cytopathogenic agents from patients with measles. Proceedings of the Society for Experimental Biology and Medicine. 1954;86(2):277-286.

15. Hilleman MR, Buynak EB, Weibel RE, Stokes J Jr. Live, attenuated measles vaccine. JAMA. 1968;206(3):587-590.

16. World Health Organization. Measles vaccines: WHO position paper – April 2017. Weekly Epidemiological Record. 2017;92(17):205-228.

17. Atwood A. The long-term effects of measles vaccination on earnings and employment. American Economic Journal: Economic Policy. 2022;14(1):34-60.

18. History of Vaccines. Measles Timeline. College of Physicians of Philadelphia. Accessed November 2, 2025. https://historyofvaccines.org/history/measles/timeline/

19. Infectious Diseases Society of America. Measles vaccination: Know the facts. Updated December 31, 2023. Accessed November 2, 2025.

20. Roush SW, Murphy TV. Historical comparisons of morbidity and mortality for vaccine-preventable diseases in the United States. JAMA. 2007;298(18):2155-2163. doi:10.1001/jama.298.18.2155
```
